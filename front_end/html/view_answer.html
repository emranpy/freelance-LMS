{% if problem_basics["exists"] %}
    {% if problem_details["show_answer"] or assignment_details["view_answer_late"] %}
        {% if not last_submission and not assignment_details["due_date"] %}
            <p>You don't have any submissions for this exercise yet. You won't be able to view the instructor's solution until you've submitted the correct answer.</p>
        {% else %}
            {% if (last_submission and last_submission["passed"]) or (assignment_details["due_date"] and curr_time > assignment_details["due_date"] and assignment_details["view_answer_late"]) %}
                <div>
                    {% if last_submission %}
                        <h4>Your solution:</h4>
                        <textarea name="student_code" id="student_code" class="textarea is-info is-normal is-medium is-fullwidth" rows="10" style="font-family:monospace">{{ last_submission["code"] }}</textarea>
                    {% end %}

                    <h4>Instructor's solution:</h4>
                    <textarea name="instructor_code" id="instructor_code" class="textarea is-info is-normal is-medium is-fullwidth" rows="10" style="font-family:monospace">{{ problem_details["answer_code"]}}</textarea>

                    {% if len(problem_details["answer_description"]) > 0 %}
                        <h4>Instructor's comments</h4>
                        <p>{{ problem_details["answer_description"] }}</p>
                        </br>
                    {% end %}
                </div></br>

                {% if problem_details["show_student_submissions"] %}
                    {% if student_submissions %}
                        <h4>Other students' solutions (anonymized):</h4>
                        {% for submission in student_submissions %}
                            <p>Submission {{ submission[0] }}:</p>
                            <pre>{{ submission[1] }}</pre>
                        {% end %}
                    {% end %}
                {% end %}

            {% else %}
                <p>Either you have not yet passed this exercise or you passed it previously but your most recent submission is not passing. Please make sure you pass the exercise, and then you'll be able to view the instructor's answer.</p>
            {% end %}
        {% end %}
    
        <p>
            <a href="/problem/{{ course_basics['id'] }}/{{ assignment_basics['id'] }}/{{ problem_basics['id'] }}">Back to exercise</a>
        </p>
    {% else %}
        <p>You do not have permission to view the answer for this exercise.</p>
    {% end %}

{% else %}
    <p>This exercise does not exist.</p>
{% end %}
<br /><br />

<script src="/static/ace.js" type="text/javascript" charset="utf-8"></script>
<script src="/static/mode-r.js" type="text/javascript"></script>
<script src="/static/ext-language_tools.js"></script>

<script>
    ace.require("ace/ext/language_tools");
    var student_code_editor = ace.edit("student_code", {
      theme: "ace/theme/{{ user_info['ace_theme'] }}",
      autoScrollEditorIntoView: true,
      minLines: 10,
      maxLines: 15,
      fontSize: "12pt"
    });
    student_code_editor.getSession().setMode("{{ code_completion_path }}");

    var instructor_code_editor = ace.edit("instructor_code", {
      theme: "ace/theme/{{ user_info['ace_theme'] }}",
      autoScrollEditorIntoView: true,
      minLines: 10,
      maxLines: 15,
      fontSize: "12pt"
    });
    instructor_code_editor.getSession().setMode("{{ code_completion_path }}");
</script>
